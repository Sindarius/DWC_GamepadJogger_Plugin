{"version":3,"sources":["webpack:///src/plugins/GamepadJogger/Jogger.vue","webpack:///./src/plugins/GamepadJogger/Jogger.vue?33a8","webpack:///./src/plugins/GamepadJogger/Jogger.vue?84f4","webpack:///./src/plugins/GamepadJogger/Jogger.vue?4af4","webpack:///./src/plugins/GamepadJogger/Jogger.vue?c524","webpack:///./src/plugins/GamepadJogger/Jogger.vue?1892","webpack:///./src/plugins/GamepadJogger/index.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","_s","gamepadName","attrs","model","value","callback","$$v","enabled","expression","stepIndex","_l","step","key","feedRateIndex","rate","staticClass","on","$event","addNewItem","showResetDialog","action","index","class","pressed","isActionSet","setActionDialog","clearAction","directives","name","rawName","type","removeCustomAction","command","control","showSetAction","resetSettings","newEntry","$set","addCustomAction","staticRenderFns","component","VBtn","VBtnToggle","VCard","VCardActions","VCardText","VCardTitle","VCol","VDialog","VForm","VRow","VSimpleTable","VSwitch","VTextField","VTextarea","registerRoute","Jogger","Settings","icon","caption","path"],"mappings":"m5BAyFA,GACA,SACA,QACA,OACA,UAGA,cACA,qBACA,OACA,WACA,WACA,eACA,kBACA,iBACA,mBACA,UACA,mBACA,SACA,+BACA,YACA,gCACA,gBACA,cACA,UACA,UACA,YAEA,aACA,iBACA,iBAGA,QA1BA,mBA2BA,sDACA,uDACA,yDAEA,cA/BA,yBAgCA,yDACA,0DACA,yDAEA,sDACA,yDADA,IAEA,UAFA,qBAGA,sCAEA,cALA,yBAMA,mDAGA,QA7CA,mBA8CA,oBACA,oCAEA,UAjDA,qBAkDA,kCAEA,qDACA,iDADA,IAEA,YAFA,qBAEA,OACA,OACA,SACA,WACA,OACA,UACA,WACA,SAGA,aAZA,wBAaA,uBAEA,aAfA,wBAgBA,uBAEA,cAlBA,uBAkBA,cAEA,sBAIA,OAHA,6BACA,2BACA,oBAIA,0DACA,6BAEA,yDAEA,+DACA,gBACA,oBACA,uBACA,wDACA,MAGA,YAxCA,qBAwCA,GACA,kCAEA,cA3CA,uBA2CA,GACA,wCACA,UAEA,MAEA,gBAjDA,yBAiDA,GACA,qBACA,uBAEA,cArDA,yBAqDA,WACA,gBAEA,oCACA,8DACA,iEAIA,8DACA,8DACA,8DACA,8DACA,+DACA,+DACA,oEACA,oEACA,uEACA,oBACA,yBAEA,YA1EA,qBA0EA,GACA,aACA,UAEA,aA9EA,wBAgFA,6CACA,EACA,2BAEA,sBAGA,aAvFA,wBAwFA,qEAEA,yBA1FA,kCA0FA,cAQA,iBACA,eACA,SACA,uBACA,kBACA,2BACA,mCACA,8BAEA,sFACA,WACA,eAEA,iBAEA,iBAEA,qBAnHA,8BAmHA,GACA,0CAGA,WACA,wBAEA,eACA,yBACA,kBAGA,oBA/HA,6BA+HA,GACA,qCAKA,OAFA,2BAEA,WACA,YACA,wCACA,iBACA,mEAEA,MACA,YACA,mBACA,iBACA,mEAEA,MACA,YACA,gDACA,qBACA,+FAEA,MACA,YAEA,2CACA,8FAEA,QAGA,aAhKA,wBAgKA,WAEA,2GACA,qBACA,yBAEA,WAyBA,GAtBA,uBAGA,iCACA,oBACA,wCAKA,mBACA,8BACA,qBACA,kBACA,mDAKA,yDAGA,iDACA,kDACA,wBACA,sBACA,yBACA,iCAEA,gBAEA,yCACA,+FAEA,8CACA,YACA,eAEA,uBAIA,YAnNA,qBAmNA,GACA,iBAIA,sDACA,cACA,qCADA,CAKA,0EACA,cAEA,oCAFA,CAMA,wDACA,YACA,mCAIA,gBA3OA,yBA2OA,KACA,kDACA,oBACA,wBACA,yBACA,oBAEA,mBAlPA,4BAkPA,GACA,yBACA,yB,4XCxYA,uGAAIA,OAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,MAAM,CAACJ,EAAIM,GAAG,kBAAkBN,EAAIO,GAAGP,EAAIQ,gBAAgBJ,EAAG,MAAM,CAACA,EAAG,WAAW,CAACK,MAAM,CAAC,MAAQ,GAAG,MAAQ,UAAUC,MAAM,CAACC,MAAOX,EAAW,QAAEY,SAAS,SAAUC,GAAMb,EAAIc,QAAQD,GAAKE,WAAW,cAAc,GAAGX,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACK,MAAM,CAAC,KAAO,MAAM,CAACT,EAAIM,GAAG,UAAUF,EAAG,MAAMA,EAAG,eAAe,CAACK,MAAM,CAAC,UAAY,GAAG,UAAY,IAAIC,MAAM,CAACC,MAAOX,EAAa,UAAEY,SAAS,SAAUC,GAAMb,EAAIgB,UAAUH,GAAKE,WAAW,cAAcf,EAAIiB,GAAIjB,EAAY,UAAE,SAASkB,GAAM,OAAOd,EAAG,QAAQ,CAACe,IAAID,GAAM,CAAClB,EAAIM,GAAG,IAAIN,EAAIO,GAAGW,SAAW,IAAI,GAAGd,EAAG,QAAQ,CAACK,MAAM,CAAC,KAAO,MAAM,CAACT,EAAIM,GAAG,qBAAqBF,EAAG,MAAMA,EAAG,eAAe,CAACK,MAAM,CAAC,UAAY,GAAG,UAAY,IAAIC,MAAM,CAACC,MAAOX,EAAiB,cAAEY,SAAS,SAAUC,GAAMb,EAAIoB,cAAcP,GAAKE,WAAW,kBAAkBf,EAAIiB,GAAIjB,EAAgB,cAAE,SAASqB,GAAM,OAAOjB,EAAG,QAAQ,CAACe,IAAIE,GAAM,CAACrB,EAAIM,GAAG,IAAIN,EAAIO,GAAGc,SAAW,IAAI,IAAI,GAAGjB,EAAG,iBAAiB,CAACA,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACA,EAAG,KAAK,CAACJ,EAAIM,GAAG,qBAAqBF,EAAG,KAAK,CAACkB,YAAY,aAAab,MAAM,CAAC,QAAU,MAAM,CAACL,EAAG,QAAQ,CAACkB,YAAY,OAAOC,GAAG,CAAC,MAAQ,SAASC,GAAQxB,EAAIyB,YAAa,KAAQ,CAACzB,EAAIM,GAAG,gBAAgBF,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQ,OAAOc,GAAG,CAAC,MAAQ,SAASC,GAAQxB,EAAI0B,iBAAkB,KAAQ,CAAC1B,EAAIM,GAAG,YAAY,KAAKF,EAAG,KAAK,CAACA,EAAG,KAAK,CAACJ,EAAIM,GAAG,YAAYF,EAAG,KAAK,CAACJ,EAAIM,GAAG,SAASF,EAAG,KAAK,CAACJ,EAAIM,GAAG,eAAeF,EAAG,KAAK,CAACJ,EAAIM,GAAG,oBAAoBF,EAAG,KAAK,CAACJ,EAAIM,GAAG,0BAA0BF,EAAG,KAAK,CAACJ,EAAIM,GAAG,sBAAsBF,EAAG,QAAQJ,EAAIiB,GAAIjB,EAAW,SAAE,SAAS2B,EAAOC,GAAO,OAAOxB,EAAG,KAAK,CAACe,IAAIS,EAAMN,YAAY,iBAAiBO,MAAM,CAAC,iBAAmBF,EAAOG,UAAU,CAAC1B,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGoB,EAAOA,WAAWvB,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGP,EAAI+B,YAAYJ,OAAYvB,EAAG,KAAK,CAACA,EAAG,QAAQ,CAACkB,YAAY,OAAOb,MAAM,CAAC,MAAQ,QAAQc,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOxB,EAAIgC,gBAAgBL,MAAW,CAAC3B,EAAIM,GAAG,SAASF,EAAG,QAAQ,CAACkB,YAAY,OAAOb,MAAM,CAAC,MAAQ,WAAWc,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOxB,EAAIiC,YAAYN,MAAW,CAAC3B,EAAIM,GAAG,WAAWF,EAAG,QAAQ,CAAC8B,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASzB,MAAuB,IAAhBgB,EAAOU,KAAYtB,WAAW,sBAAsBN,MAAM,CAAC,MAAQ,SAASc,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOxB,EAAIsC,mBAAmBV,MAAU,CAAC5B,EAAIM,GAAG,aAAa,GAAGF,EAAG,KAAK,CAACA,EAAG,OAAO,CAAC8B,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASzB,MAAuB,IAAhBgB,EAAOU,KAAYtB,WAAW,uBAAuB,CAACf,EAAIM,GAAGN,EAAIO,GAAGoB,EAAOY,cAAcnC,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGoB,EAAOa,YAAYpC,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGoB,EAAOR,aAAY,KAAKf,EAAG,WAAW,CAACK,MAAM,CAAC,YAAY,OAAOC,MAAM,CAACC,MAAOX,EAAiB,cAAEY,SAAS,SAAUC,GAAMb,EAAIyC,cAAc5B,GAAKE,WAAW,kBAAkB,CAACX,EAAG,SAAS,CAACA,EAAG,eAAe,CAACJ,EAAIM,GAAG,gBAAgBF,EAAG,cAAc,CAACJ,EAAIM,GAAG,iDAAiDF,EAAG,iBAAiB,CAACA,EAAG,QAAQ,CAACmB,GAAG,CAAC,MAAQ,SAASC,GAAQxB,EAAIyC,eAAiBzC,EAAIyC,iBAAiB,CAACzC,EAAIM,GAAG,aAAa,IAAI,IAAI,GAAGF,EAAG,WAAW,CAACK,MAAM,CAAC,YAAY,OAAOC,MAAM,CAACC,MAAOX,EAAmB,gBAAEY,SAAS,SAAUC,GAAMb,EAAI0B,gBAAgBb,GAAKE,WAAW,oBAAoB,CAACX,EAAG,SAAS,CAACK,MAAM,CAAC,YAAY,MAAM,SAAW,KAAK,CAACL,EAAG,eAAe,CAACJ,EAAIM,GAAG,oBAAoBF,EAAG,cAAc,CAACJ,EAAIM,GAAG,mCAAmCF,EAAG,iBAAiB,CAACA,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQ,MAAM,MAAQ,OAAOc,GAAG,CAAC,MAAQvB,EAAI0C,gBAAgB,CAAC1C,EAAIM,GAAG,WAAWN,EAAIM,GAAG,KAAKF,EAAG,QAAQ,CAACK,MAAM,CAAC,MAAQ,OAAO,MAAQ,OAAOc,GAAG,CAAC,MAAQ,SAASC,GAAQxB,EAAI0B,iBAAkB,KAAS,CAAC1B,EAAIM,GAAG,aAAa,IAAI,IAAI,GAAGF,EAAG,WAAW,CAACK,MAAM,CAAC,YAAY,OAAOC,MAAM,CAACC,MAAOX,EAAc,WAAEY,SAAS,SAAUC,GAAMb,EAAIyB,WAAWZ,GAAKE,WAAW,eAAe,CAACX,EAAG,SAAS,CAACA,EAAG,eAAe,CAACJ,EAAIM,GAAG,oBAAoBF,EAAG,cAAc,CAACA,EAAG,SAAS,CAACA,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,eAAeC,MAAM,CAACC,MAAOX,EAAI2C,SAAe,OAAE/B,SAAS,SAAUC,GAAMb,EAAI4C,KAAK5C,EAAI2C,SAAU,SAAU9B,IAAME,WAAW,qBAAqBX,EAAG,aAAa,CAACK,MAAM,CAAC,MAAQ,UAAU,YAAY,GAAG,OAAS,IAAIC,MAAM,CAACC,MAAOX,EAAI2C,SAAgB,QAAE/B,SAAS,SAAUC,GAAMb,EAAI4C,KAAK5C,EAAI2C,SAAU,UAAW9B,IAAME,WAAW,sBAAsBX,EAAG,QAAQ,CAACmB,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOxB,EAAI6C,gBAAgB7C,EAAI2C,SAAShB,OAAQ3B,EAAI2C,SAASJ,YAAY,CAACvC,EAAIM,GAAG,UAAUF,EAAG,QAAQ,CAACmB,GAAG,CAAC,MAAQ,SAASC,GAAQxB,EAAIyB,YAAa,KAAS,CAACzB,EAAIM,GAAG,YAAY,IAAI,IAAI,IAAI,IAAI,IACn2IwC,EAAkB,I,sbCDtB,6nCAQIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MAIa,aAAAA,EAAiB,QAkBhC,IAAkBA,EAAW,CAACC,KAAA,aAAKC,WAAA,aAAWC,MAAA,aAAMC,aAAA,kBAAaC,UAAA,eAAUC,WAAA,gBAAWC,KAAA,aAAKC,QAAA,aAAQC,MAAA,aAAMC,KAAA,aAAKC,aAAA,aAAaC,QAAA,aAAQC,WAAA,aAAWC,UAAA,gB,+FCrC9I,8RAA+V,2B,uGCA/V,2c,qGCAA,oe,oECAA,sFAIAC,2BAAcC,aAAQ,CACpBC,SAAU,CACRD,OAAQ,CACNE,KAAM,sBACNC,QAAS,SACTC,KAAM","file":"js/GamepadJogger.29aa97cf.js","sourcesContent":["<template>\r\n    <div>\r\n        <div>Gamepad Name : {{gamepadName}}</div>\r\n        <div>\r\n            <v-switch inset v-model=\"enabled\" label=\"Enable\"></v-switch>\r\n        </div>\r\n        <v-row>\r\n            <v-col cols=\"6\">\r\n                Steps<br />\r\n                <v-btn-toggle mandatory exclusive v-model=\"stepIndex\">\r\n                    <v-btn v-for=\"step in stepList\" :key=\"step\"> {{step}}</v-btn>\r\n                </v-btn-toggle>\r\n            </v-col>\r\n            <v-col cols=\"6\">\r\n                Feed Rate (mm/s)<br />\r\n                <v-btn-toggle mandatory exclusive v-model=\"feedRateIndex\">\r\n                    <v-btn v-for=\"rate in feedRateList\" :key=\"rate\"> {{rate}}</v-btn>\r\n                </v-btn-toggle>\r\n            </v-col>\r\n        </v-row>\r\n        <v-simple-table>\r\n            <thead>\r\n                <tr>\r\n                    <td><h2>Configuration</h2></td>\r\n                    <td colspan=\"4\" class=\"cell-right\">\r\n                        <v-btn class=\"mr-2\" @click=\"addNewItem = true\">New Action</v-btn>\r\n                        <v-btn @click=\"showResetDialog = true\" color=\"red\">Reset</v-btn>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <th>Action</th>\r\n                    <th>Set</th>\r\n                    <th>Configure</th>\r\n                    <th>Custom Command</th>\r\n                    <th>Controller Button Id</th>\r\n                    <th>Keyboard Key</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr v-for=\"(action,index) in actions\" :key=\"index\" class=\"action-control\" :class=\"{'action-pressed' : action.pressed}\">\r\n                    <td>{{action.action}}</td>\r\n                    <td>{{ isActionSet(action) }}</td>\r\n                    <td>\r\n                        <v-btn class=\"mr-1\" @click=\"setActionDialog(action)\" color=\"info\">Set</v-btn>\r\n                        <v-btn @click=\"clearAction(action)\" color=\"warning\" class=\"mr-1\">Clear</v-btn>\r\n                        <v-btn v-show=\"action.type === 3\" @click=\"removeCustomAction(index)\" color=\"error\">Delete</v-btn>\r\n                    </td>\r\n                    <td>\r\n                        <span v-show=\"action.type === 3\">{{action.command}}</span>\r\n                    </td>\r\n                    <td>{{action.control}}</td>\r\n                    <td>{{action.key}}</td>\r\n                </tr>\r\n            </tbody>\r\n        </v-simple-table>\r\n        <v-dialog v-model=\"showSetAction\" max-width=\"325\">\r\n            <v-card>\r\n                <v-card-title>Set Action</v-card-title>\r\n                <v-card-text>Press a button or move an axis to set value</v-card-text>\r\n                <v-card-actions> <v-btn @click=\"showSetAction = !showSetAction\">Cancel</v-btn> </v-card-actions>\r\n            </v-card>\r\n        </v-dialog>\r\n        <v-dialog v-model=\"showResetDialog\" max-width=\"325\">\r\n            <v-card max-width=\"325\" outlined>\r\n                <v-card-title>Reset Settings</v-card-title>\r\n                <v-card-text>Click reset to confirm reset.</v-card-text>\r\n                <v-card-actions> <v-btn @click=\"resetSettings\" color=\"red\" width=\"150\">Reset</v-btn> <v-btn color=\"info\" @click=\"showResetDialog = false\" width=\"150\">Cancel</v-btn> </v-card-actions>\r\n            </v-card>\r\n        </v-dialog>\r\n        <v-dialog v-model=\"addNewItem\" max-width=\"325\">\r\n            <v-card>\r\n                <v-card-title>Add New Action</v-card-title>\r\n                <v-card-text>\r\n                    <v-form>\r\n                        <v-text-field v-model=\"newEntry.action\" label=\"Action Name\"></v-text-field>\r\n                        <v-textarea v-model=\"newEntry.command\" label=\"Command\" auto-grow filled></v-textarea>\r\n                        <v-btn @click=\"addCustomAction(newEntry.action, newEntry.command)\">Save</v-btn>\r\n                        <v-btn @click=\"addNewItem = false\">Close</v-btn>\r\n                    </v-form>\r\n                </v-card-text>\r\n            </v-card>\r\n        </v-dialog>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport { mapActions, mapState } from 'vuex';\r\n\r\nlet commandType = {\r\n\tplugin: 0, //Plugin commands perform an action that drives a chance in the plugin itself like steps or feedrate\r\n\tgcode: 1, //GCode command sends gcode to the duet\r\n\tmove: 2, //Move  commands require processing to add steps and feedrate before being sent to duet\r\n\tcustom: 3, //Allow for user customized gcode macros to be attached to a button. A good example is running a macro with M98 P\"X\"\r\n};\r\n\r\nexport default {\r\n\tdata: function () {\r\n\t\treturn {\r\n\t\t\tactions: [],\r\n\t\t\tenabled: false,\r\n\t\t\tgamepadName: '',\r\n\t\t\tactiveControls: [],\r\n\t\t\tshowSetAction: false,\r\n\t\t\tsettingAction: null,\r\n\t\t\tmoving: false,\r\n\t\t\tshowResetDialog: false,\r\n\t\t\tdebug: false,\r\n\t\t\tstepList: [0.1, 1, 5, 10, 20, 50, 100],\r\n\t\t\tstepIndex: 2,\r\n\t\t\tfeedRateList: [1, 5, 15, 30, 60, 100],\r\n\t\t\tfeedRateIndex: 3,\r\n\t\t\taddNewItem: false,\r\n\t\t\tnewEntry: {\r\n\t\t\t\taction: '',\r\n\t\t\t\tcommand: '',\r\n\t\t\t},\r\n\t\t\tlastAction: 0,\r\n\t\t\tinputHasFocus: false,\r\n\t\t\tlastKeyPress: 0,\r\n\t\t};\r\n\t},\r\n\tcreated() {\r\n\t\twindow.addEventListener('keydown', this.checkKeyPress);\r\n\t\tdocument.addEventListener('focusin', this.inputFocused);\r\n\t\tdocument.addEventListener('focusout', this.inputBlurred);\r\n\t},\r\n\tbeforeDestroy() {\r\n\t\twindow.removeEventListener('keydown', this.checkKeyPress);\r\n\t\tdocument.removeEventListener('focusin', this.inputFocused);\r\n\t\tdocument.addEventListener('focusout', this.inputBlurred);\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState('machine/model', ['move', 'state']),\r\n\t\tstepValue() {\r\n\t\t\treturn this.stepList[this.stepIndex];\r\n\t\t},\r\n\t\tfeedRateValue() {\r\n\t\t\treturn this.feedRateList[this.feedRateIndex] * 60;\r\n\t\t},\r\n\t},\r\n\tmounted() {\r\n\t\tthis.loadSettings();\r\n\t\tsetInterval(this.checkGamepad, 100);\r\n\t},\r\n\tunmounted() {\r\n\t\tclearInterval(this.checkGamepad);\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['sendCode']),\r\n\t\tbuildAction(action, type, command) {\r\n\t\t\treturn {\r\n\t\t\t\taction: action,\r\n\t\t\t\tcontrol: '',\r\n\t\t\t\ttype: type,\r\n\t\t\t\tcommand: command,\r\n\t\t\t\tpressed: false,\r\n\t\t\t\tkey: '',\r\n\t\t\t};\r\n\t\t},\r\n\t\tinputFocused() {\r\n\t\t\tthis.inputHasFocus = true;\r\n\t\t},\r\n\t\tinputBlurred() {\r\n\t\t\tthis.inputHasFocus = false;\r\n\t\t},\r\n\t\tcheckKeyPress(evt) {\r\n\t\t\t//Check if we are setting a key\r\n\t\t\tif (this.showSetAction) {\r\n\t\t\t\tthis.settingAction.key = evt.key;\r\n\t\t\t\tthis.showSetAction = false;\r\n\t\t\t\tthis.saveSettings();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.inputHasFocus && Date.now() - this.lastKeyPress > 100) {\r\n\t\t\t\tthis.lastKeyPress = Date.now();\r\n\r\n\t\t\t\tthis.actions.forEach(action => (action.pressed = false));\r\n\r\n\t\t\t\tlet firedAction = this.actions.filter(action => action.key === evt.key);\r\n\t\t\t\tfiredAction[0].pressed = true;\r\n\t\t\t\tthis.fireActions(firedAction);\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.actions.forEach(action => (action.pressed = false));\r\n\t\t\t\t}, 90);\r\n\t\t\t}\r\n\t\t},\r\n\t\tisActionSet(action) {\r\n\t\t\treturn action.control !== '' || action.key !== '';\r\n\t\t},\r\n\t\tbuttonPressed(b) {\r\n\t\t\tif (typeof b == 'object') {\r\n\t\t\t\treturn b.pressed;\r\n\t\t\t}\r\n\t\t\treturn b == 1.0;\r\n\t\t},\r\n\t\tsetActionDialog(action) {\r\n\t\t\tthis.settingAction = action;\r\n\t\t\tthis.showSetAction = true;\r\n\t\t},\r\n\t\tresetSettings() {\r\n\t\t\tthis.actions = [];\r\n\t\t\t//lets build a new  action list from the axes\r\n\t\t\tthis.move.axes.forEach(axis => {\r\n\t\t\t\tthis.actions.push(this.buildAction(`${axis.letter}+`, commandType.move));\r\n\t\t\t\tthis.actions.push(this.buildAction(`${axis.letter}-`, commandType.move));\r\n\t\t\t});\r\n\r\n\t\t\t//Add some default commands we'll handle\r\n\t\t\tthis.actions.push(this.buildAction('Home X', commandType.gcode, 'G28 X'));\r\n\t\t\tthis.actions.push(this.buildAction('Home Y', commandType.gcode, 'G28 Y'));\r\n\t\t\tthis.actions.push(this.buildAction('Home Z', commandType.gcode, 'G28 Z'));\r\n\t\t\tthis.actions.push(this.buildAction('Home All', commandType.gcode, 'G28'));\r\n\t\t\tthis.actions.push(this.buildAction('Step +', commandType.plugin, 'step+'));\r\n\t\t\tthis.actions.push(this.buildAction('Step -', commandType.plugin, 'step-'));\r\n\t\t\tthis.actions.push(this.buildAction('Feed Rate +', commandType.plugin, 'feed+'));\r\n\t\t\tthis.actions.push(this.buildAction('Feed Rate -', commandType.plugin, 'feed-'));\r\n\t\t\tthis.actions.push(this.buildAction('Set Zero', commandType.gcode, 'G92 X0 Y0 Z0'));\r\n\t\t\tthis.saveSettings();\r\n\t\t\tthis.showResetDialog = false;\r\n\t\t},\r\n\t\tclearAction(action) {\r\n\t\t\taction.control = '';\r\n\t\t\taction.key = '';\r\n\t\t},\r\n\t\tloadSettings() {\r\n\t\t\t//Check for saved settings\r\n\t\t\tlet actionsString = localStorage.getItem('joggerSettings');\r\n\t\t\tif (actionsString) {\r\n\t\t\t\tthis.actions = JSON.parse(actionsString);\r\n\t\t\t} else {\r\n\t\t\t\tthis.resetSettings();\r\n\t\t\t}\r\n\t\t},\r\n\t\tsaveSettings() {\r\n\t\t\tlocalStorage.setItem('joggerSettings', JSON.stringify(this.actions));\r\n\t\t},\r\n\t\tgenerateGCodeMoveCommand(moves) {\r\n\t\t\t/*\r\n                        Maybe look into computing estimated time of completions for a move to smooth \r\n                        if (Date.now() - this.lastAction < 500) {\r\n                          return;\r\n                        }\r\n                        this.lastAction = Date.now();\r\n                        */\r\n\t\t\tif (this.moving) return; //discard any commands while moving\r\n\t\t\tthis.moving = true;\r\n\t\t\tlet moveCommands = '';\r\n\t\t\tmoves.forEach(axisAction => {\r\n\t\t\t\tvar axis = axisAction.action[0];\r\n\t\t\t\tvar direction = axisAction.action[1] === '+' ? '' : '-';\r\n\t\t\t\tvar move = `${direction}${this.stepValue}`;\r\n\t\t\t\tmoveCommands += ` ${axis}${move}`;\r\n\t\t\t});\r\n\t\t\tvar command = `M120\\nG91\\nG1 ${moveCommands.trim()} F${this.feedRateValue}\\nG90\\nM121`;\r\n\t\t\tif (this.debug) {\r\n\t\t\t\tconsole.log(command);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendCode(command);\r\n\t\t\t}\r\n\t\t\tthis.moving = false;\r\n\t\t},\r\n\t\tgenerateGCodeCommand(gcode) {\r\n\t\t\tif (this.moving || this.state.status !== 'idle') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.debug) {\r\n\t\t\t\tconsole.log(gcode.command);\r\n\t\t\t} else {\r\n\t\t\t\tthis.moving = true;\r\n\t\t\t\tthis.sendCode(gcode.command);\r\n\t\t\t\tthis.moving = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tperformPluginAction(action) {\r\n\t\t\tif (Date.now() - this.lastAction < 500) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.lastAction = Date.now();\r\n\r\n\t\t\tswitch (action.command) {\r\n\t\t\t\tcase 'step+':\r\n\t\t\t\t\tif (this.stepIndex < this.stepList.length - 1) {\r\n\t\t\t\t\t\tthis.stepIndex++;\r\n\t\t\t\t\t\tthis.sendCode(`M117 \"Jogger Step :  ${this.stepValue}\"`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'step-':\r\n\t\t\t\t\tif (this.stepIndex > 0) {\r\n\t\t\t\t\t\tthis.stepIndex--;\r\n\t\t\t\t\t\tthis.sendCode(`M117 \"Jogger Step :  ${this.stepValue}\"`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'feed+':\r\n\t\t\t\t\tif (this.feedRateIndex < this.feedRateList.length - 1) {\r\n\t\t\t\t\t\tthis.feedRateIndex++;\r\n\t\t\t\t\t\tthis.sendCode(`M117 \"Jogger Feed Rate :  ${this.feedRateList[this.feedRateIndex]}\"`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'feed-':\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (this.feedRateIndex > 0) this.feedRateIndex--;\r\n\t\t\t\t\t\tthis.sendCode(`M117 \"Jogger Feed Rate :  ${this.feedRateList[this.feedRateIndex]}\"`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\tcheckGamepad() {\r\n\t\t\t//check if gamepads are connected and update their current button/axis states\r\n\t\t\tvar gamepads = navigator.getGamepads ? navigator.getGamepads() : navigator.webkitGetGamepads ? navigator.webkitGetGamepads : [];\r\n\t\t\tif (gamepads.length > 0 && gamepads[0]) {\r\n\t\t\t\tthis.gamepadName = gamepads[0].id;\r\n\r\n\t\t\t\tlet gamepad = gamepads[0]; //we'll just work with the first controller that is detected for now.\r\n\r\n\t\t\t\t//Collection of all the buttons/axes activated on this frame\r\n\t\t\t\tthis.activeControls = [];\r\n\r\n\t\t\t\t//Get a collection of pushed buttons\r\n\t\t\t\tgamepad.buttons.forEach((b, i) => {\r\n\t\t\t\t\tif (this.buttonPressed(b)) {\r\n\t\t\t\t\t\tthis.activeControls.push(`B${i}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t//Check the axes controls to see if they exceed threshold\r\n\t\t\t\tthis.activeAxes = '';\r\n\t\t\t\tgamepad.axes.forEach((axis, index) => {\r\n\t\t\t\t\tif (1 - Math.abs(axis) < 0.5) {\r\n\t\t\t\t\t\tlet sign = axis > 0 ? '+' : '-';\r\n\t\t\t\t\t\tthis.activeControls.push(`A${index}${sign}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t//Clear all of the actions from the last pass\r\n\t\t\t\tthis.actions.forEach(a => (a.pressed = false));\r\n\r\n\t\t\t\t//check if we are setting a control\r\n\t\t\t\tif (this.settingAction && this.activeControls.length > 0) {\r\n\t\t\t\t\tthis.settingAction.control = this.activeControls[0];\r\n\t\t\t\t\tthis.settingAction = null;\r\n\t\t\t\t\tthis.showSetAction = false;\r\n\t\t\t\t\tthis.saveSettings();\r\n\t\t\t\t} else if (this.activeControls.length > 0) {\r\n\t\t\t\t\t//Perform activated actions\r\n\t\t\t\t\tlet firedActions = new Array();\r\n\t\t\t\t\t//get a list of fired commands\r\n\t\t\t\t\tthis.activeControls.forEach(control => {\r\n\t\t\t\t\t\tfiredActions.push(...this.actions.filter(action => action.control === control));\r\n\t\t\t\t\t});\r\n\t\t\t\t\tfiredActions.forEach(a => (a.pressed = true));\r\n\t\t\t\t\tif (this.debug) {\r\n\t\t\t\t\t\tconsole.log(firedActions);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.fireActions(firedActions);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tfireActions(firedActions) {\r\n\t\t\tif (!this.enabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet moves = firedActions.filter(act => act.type === commandType.move);\r\n\t\t\tif (moves.length > 0) {\r\n\t\t\t\tthis.generateGCodeMoveCommand(moves);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet gcode = firedActions.filter(act => act.type === commandType.gcode || act.type === commandType.custom);\r\n\t\t\tif (gcode.length > 0) {\r\n\t\t\t\t//for now we'll only allow one gcode command to be fired;\r\n\t\t\t\tthis.generateGCodeCommand(gcode[0]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet plugins = firedActions.filter(act => act.type === commandType.plugin);\r\n\t\t\tif (plugins.length > 0) {\r\n\t\t\t\tthis.performPluginAction(plugins[0]); //only do the first command\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t},\r\n\t\taddCustomAction(action, command) {\r\n\t\t\tthis.actions.push(this.buildAction(action, commandType.custom, command));\r\n\t\t\tthis.saveSettings();\r\n\t\t\tthis.newEntry.action = '';\r\n\t\t\tthis.newEntry.command = '';\r\n\t\t\tthis.addNewItem = false;\r\n\t\t},\r\n\t\tremoveCustomAction(index) {\r\n\t\t\tthis.actions.splice(index, 1);\r\n\t\t\tthis.saveSettings();\r\n\t\t},\r\n\t},\r\n};\r\n</script>\r\n\r\n<style>\r\n.action-control {\r\n\tbackground-color: transparent;\r\n\t-webkit-transition-duration: 0.3s;\r\n\t-moz-transition-duration: 0.3s;\r\n\t-o-transition-duration: 0.3s;\r\n\ttransition-duration: 0.3s;\r\n}\r\n\r\n.action-pressed {\r\n\tbackground-color: blue;\r\n}\r\n\r\n.cell-right {\r\n\ttext-align: right;\r\n}\r\n</style>","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',[_vm._v(\"Gamepad Name : \"+_vm._s(_vm.gamepadName))]),_c('div',[_c('v-switch',{attrs:{\"inset\":\"\",\"label\":\"Enable\"},model:{value:(_vm.enabled),callback:function ($$v) {_vm.enabled=$$v},expression:\"enabled\"}})],1),_c('v-row',[_c('v-col',{attrs:{\"cols\":\"6\"}},[_vm._v(\" Steps\"),_c('br'),_c('v-btn-toggle',{attrs:{\"mandatory\":\"\",\"exclusive\":\"\"},model:{value:(_vm.stepIndex),callback:function ($$v) {_vm.stepIndex=$$v},expression:\"stepIndex\"}},_vm._l((_vm.stepList),function(step){return _c('v-btn',{key:step},[_vm._v(\" \"+_vm._s(step))])}),1)],1),_c('v-col',{attrs:{\"cols\":\"6\"}},[_vm._v(\" Feed Rate (mm/s)\"),_c('br'),_c('v-btn-toggle',{attrs:{\"mandatory\":\"\",\"exclusive\":\"\"},model:{value:(_vm.feedRateIndex),callback:function ($$v) {_vm.feedRateIndex=$$v},expression:\"feedRateIndex\"}},_vm._l((_vm.feedRateList),function(rate){return _c('v-btn',{key:rate},[_vm._v(\" \"+_vm._s(rate))])}),1)],1)],1),_c('v-simple-table',[_c('thead',[_c('tr',[_c('td',[_c('h2',[_vm._v(\"Configuration\")])]),_c('td',{staticClass:\"cell-right\",attrs:{\"colspan\":\"4\"}},[_c('v-btn',{staticClass:\"mr-2\",on:{\"click\":function($event){_vm.addNewItem = true}}},[_vm._v(\"New Action\")]),_c('v-btn',{attrs:{\"color\":\"red\"},on:{\"click\":function($event){_vm.showResetDialog = true}}},[_vm._v(\"Reset\")])],1)]),_c('tr',[_c('th',[_vm._v(\"Action\")]),_c('th',[_vm._v(\"Set\")]),_c('th',[_vm._v(\"Configure\")]),_c('th',[_vm._v(\"Custom Command\")]),_c('th',[_vm._v(\"Controller Button Id\")]),_c('th',[_vm._v(\"Keyboard Key\")])])]),_c('tbody',_vm._l((_vm.actions),function(action,index){return _c('tr',{key:index,staticClass:\"action-control\",class:{'action-pressed' : action.pressed}},[_c('td',[_vm._v(_vm._s(action.action))]),_c('td',[_vm._v(_vm._s(_vm.isActionSet(action)))]),_c('td',[_c('v-btn',{staticClass:\"mr-1\",attrs:{\"color\":\"info\"},on:{\"click\":function($event){return _vm.setActionDialog(action)}}},[_vm._v(\"Set\")]),_c('v-btn',{staticClass:\"mr-1\",attrs:{\"color\":\"warning\"},on:{\"click\":function($event){return _vm.clearAction(action)}}},[_vm._v(\"Clear\")]),_c('v-btn',{directives:[{name:\"show\",rawName:\"v-show\",value:(action.type === 3),expression:\"action.type === 3\"}],attrs:{\"color\":\"error\"},on:{\"click\":function($event){return _vm.removeCustomAction(index)}}},[_vm._v(\"Delete\")])],1),_c('td',[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(action.type === 3),expression:\"action.type === 3\"}]},[_vm._v(_vm._s(action.command))])]),_c('td',[_vm._v(_vm._s(action.control))]),_c('td',[_vm._v(_vm._s(action.key))])])}),0)]),_c('v-dialog',{attrs:{\"max-width\":\"325\"},model:{value:(_vm.showSetAction),callback:function ($$v) {_vm.showSetAction=$$v},expression:\"showSetAction\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\"Set Action\")]),_c('v-card-text',[_vm._v(\"Press a button or move an axis to set value\")]),_c('v-card-actions',[_c('v-btn',{on:{\"click\":function($event){_vm.showSetAction = !_vm.showSetAction}}},[_vm._v(\"Cancel\")])],1)],1)],1),_c('v-dialog',{attrs:{\"max-width\":\"325\"},model:{value:(_vm.showResetDialog),callback:function ($$v) {_vm.showResetDialog=$$v},expression:\"showResetDialog\"}},[_c('v-card',{attrs:{\"max-width\":\"325\",\"outlined\":\"\"}},[_c('v-card-title',[_vm._v(\"Reset Settings\")]),_c('v-card-text',[_vm._v(\"Click reset to confirm reset.\")]),_c('v-card-actions',[_c('v-btn',{attrs:{\"color\":\"red\",\"width\":\"150\"},on:{\"click\":_vm.resetSettings}},[_vm._v(\"Reset\")]),_vm._v(\" \"),_c('v-btn',{attrs:{\"color\":\"info\",\"width\":\"150\"},on:{\"click\":function($event){_vm.showResetDialog = false}}},[_vm._v(\"Cancel\")])],1)],1)],1),_c('v-dialog',{attrs:{\"max-width\":\"325\"},model:{value:(_vm.addNewItem),callback:function ($$v) {_vm.addNewItem=$$v},expression:\"addNewItem\"}},[_c('v-card',[_c('v-card-title',[_vm._v(\"Add New Action\")]),_c('v-card-text',[_c('v-form',[_c('v-text-field',{attrs:{\"label\":\"Action Name\"},model:{value:(_vm.newEntry.action),callback:function ($$v) {_vm.$set(_vm.newEntry, \"action\", $$v)},expression:\"newEntry.action\"}}),_c('v-textarea',{attrs:{\"label\":\"Command\",\"auto-grow\":\"\",\"filled\":\"\"},model:{value:(_vm.newEntry.command),callback:function ($$v) {_vm.$set(_vm.newEntry, \"command\", $$v)},expression:\"newEntry.command\"}}),_c('v-btn',{on:{\"click\":function($event){return _vm.addCustomAction(_vm.newEntry.action, _vm.newEntry.command)}}},[_vm._v(\"Save\")]),_c('v-btn',{on:{\"click\":function($event){_vm.addNewItem = false}}},[_vm._v(\"Close\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./Jogger.vue?vue&type=template&id=59bbce00&\"\nimport script from \"./Jogger.vue?vue&type=script&lang=js&\"\nexport * from \"./Jogger.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Jogger.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VBtnToggle } from 'vuetify/lib/components/VBtnToggle';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSimpleTable } from 'vuetify/lib/components/VDataTable';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VTextarea } from 'vuetify/lib/components/VTextarea';\ninstallComponents(component, {VBtn,VBtnToggle,VCard,VCardActions,VCardText,VCardTitle,VCol,VDialog,VForm,VRow,VSimpleTable,VSwitch,VTextField,VTextarea})\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Jogger.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Jogger.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Jogger.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"5cc64625-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Jogger.vue?vue&type=template&id=59bbce00&\"","'use strict'\r\nimport { registerRoute } from '../../routes';\r\nimport Jogger from './Jogger.vue';\r\n\r\nregisterRoute(Jogger, {\r\n  Settings: {\r\n    Jogger: {\r\n      icon: 'mdi-gamepad-variant',\r\n      caption: 'Jogger',\r\n      path: '/Jogger',\r\n    },\r\n  },\r\n});\r\n"],"sourceRoot":""}